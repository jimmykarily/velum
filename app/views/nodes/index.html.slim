.alert.alert-info.alert-dismissible role="alert"
  button.close[type="button" data-dismiss="alert" aria-label="Close"]
    span[aria-hidden="true"]
      | &times;
  i.fa.fa-4x.pull-left aria-hidden="true"
  span
    | After choosing the master and clicking "Bootstrap Cluster" all other nodes will be set to the minion role
h1 Nodes
.row
  .col-xs-12.discovery-control
    span #{Minion.count} Nodes found
= form_tag(nodes_path, method: "put")
.nodes-container data-url=nodes_path
  - master_already_exists = Minion.exists?(role: "master")
  table.table data-master-exists=master_already_exists.to_s
    thead
      tr
        th
          | Id
        th.text-center
          | Status
        th
          | Hostname
        th
          | Role
        th.text-center
          | Master
    tbody
      - Minion.all.each do |m|
        - #TODO  Make this match javascript classes
        tr
          th
            | #{m.id}
          td.text-center
            - if m.role
              i.fa.fa-check-circle-o.text-success.fa-2x aria-hidden="true"
            - else
              span.fa-stack aria-hidden="true"
                i.fa.fa-circle.fa-stack-2x.text-success aria-hidden="true"
                i.fa.fa-refresh.fa-stack-1x.fa-spin.fa-inverse aria-hidden="true"
          td
            | #{m.hostname}
          td
            | #{m.role}
          td.text-center
            - if m.role == "master"
              = radio_button_tag "roles[master]", m.id, true, disabled: true
            - elsif master_already_exists
              = radio_button_tag "roles[master]", m.id, false, disabled: true
            - else
              = radio_button_tag "roles[master]", m.id
  .clearfix.text-right.steps-container
    a.btn.btn-danger[href="/"] Back
    - if Minion.exists?(role: "master")
      = submit_tag "Bootstrap Cluster", class: "btn btn-primary", disabled: true
    - else
      = submit_tag "Bootstrap Cluster", class: "btn btn-primary"

  = render "dashboard/polling"
